{"title": "How to redirect an incoming connection to a different IP address on a specific port using IPtables", "content": "<p>Problem<br />\nRedirect traffic incoming on a specific port to a different IP address / another server</p>\n<p>tl;dr</p>\n<h4>Step 1:</h4>\n<pre><code data-enlighter-language=\"null\">iptables -t nat -A PREROUTING -p tcp --dport 3124 -j DNAT --to-destination 1.1.1.1:3000\r\niptables -t nat -A POSTROUTING -j MASQUERADE</code></pre>\n<p>Solution</p>\n<p>Below will show you how to redirect port 3124 on one machine to port 3000 on a different machine / IP address.<br />\nThis can be useful for firewall related reasons.</p>\n<pre><code data-enlighter-language=\"null\">iptables -t nat -A PREROUTING -p tcp --dport 3124 -j DNAT --to-destination 1.1.1.1:3000\r\n</code></pre>\n<p>This will route traffic incoming on port 3124 to 1.1.1.1 on port 3000.<br />\nYou can put in any port or IP address you need there.</p>\n<h4>Step 2:</h4>\n<pre><code data-enlighter-language=\"null\">iptables -t nat -A POSTROUTING -j MASQUERADE\r\n</code></pre>\n<p>We set MASQUERADE to mask the IP address of the connecting system and use the gateway IP address instead. This is necessary for it to communicate back to the gateway, then to your client.</p>\n<p>That is all that is required to get this to work.</p>\n<h4>Optional:</h4>\n<pre><code data-enlighter-language=\"null\">service iptables save\r\n</code></pre>\n<p>This will save the changes, so they are persistent after a reboot.</p>\n<div id=\"knowledgebase_vote\" class=\"spacing\">\n<div>\n<div>Source : <a href=\"https://my.esecuredata.com/index.php?/knowledgebase/article/49/how-to-redirect-an-incoming-connection-to-a-different-ip-address-on-a-specific-port-using-iptables/\">https://my.esecuredata.com/index.php?/knowledgebase/article/49/how-to-redirect-an-incoming-connection-to-a-different-ip-address-on-a-specific-port-using-iptables/</a></div>\n</div>\n</div>\n", "slug": "how-to-redirect-an-incoming-connection-to-a-different-ip-address-on-a-specific-port-using-iptables", "date": 1584175942, "cats": [0, 4, 12, 5, 10]}