{"title": "Install rancher on k3s using kubectl yaml", "content": "<pre><code data-enlighter-language=\"null\">apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  labels:\r\n    run: rancher\r\n  name: rancher-deploy\r\n  namespace: rch\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      run: rancher\r\n  template:\r\n    metadata:\r\n      labels:\r\n        run: rancher\r\n    spec:\r\n      serviceAccountName: rch-admin\r\n      containers:\r\n      - image: rancher/rancher\r\n        name: rancher\r\n---\r\napiVersion: v1\r\nkind: ServiceAccount\r\nmetadata:\r\n  name: rch-admin\r\n  namespace: rch\r\n---\r\napiVersion: rbac.authorization.k8s.io/v1beta1\r\nkind: ClusterRoleBinding\r\nmetadata:\r\n  name: rch-admin\r\nroleRef:\r\n  apiGroup: rbac.authorization.k8s.io\r\n  kind: ClusterRole\r\n  name: cluster-admin\r\nsubjects:\r\n- kind: ServiceAccount\r\n  name: rch-admin\r\n  namespace: rch\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: rancher-service\r\n  namespace: rch\r\n  labels:\r\n    run: rancher\r\nspec:\r\n  ports:\r\n  - port: 80\r\n    protocol: TCP\r\n  selector:\r\n    run: rancher\r\n---\r\napiVersion: extensions/v1beta1\r\nkind: Ingress\r\nmetadata:\r\n  name: rch-ingress\r\n  namespace: rch\r\n  annotations:\r\n    kubernetes.io/ingress.class: \"traefik\"\r\n    traefik.frontend.rule.type: PathPrefixStrip\r\n    traefik.ingress.kubernetes.io/frontend-entry-points: http, https\r\nspec:\r\n  tls:\r\n  - hosts:\r\n    - rch.app.eramax.net\r\n  rules:\r\n  - host: rch.app.eramax.net\r\n    http:\r\n      paths:\r\n      - backend:\r\n          serviceName: rancher-service\r\n          servicePort: 80\r\n        path: /\r\n</code></pre>\n<p><strong>Then access your ingress url using https.</strong></p>\n<p> </p>\n", "slug": "install-rancher-on-k3s-using-kubectl-yaml", "date": 1586276567, "cats": [0, 1, 2, 3, 4]}